(()=>{"use strict";var t="https://nomoreparties.co/v1/",e="wff-cohort-12",n="99703b1e-7ce0-4717-b386-e423a10c9b54",o="application/json",r=function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))},c=function(t,e,n,o,r){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),i=c.querySelector(".card__image"),a=c.querySelector(".card__title"),u=c.querySelector(".card__delete-button"),l=c.querySelector(".card__like-button");return i.alt=t.name,i.src=t.link,a.textContent=t.name,l.textContent=t.likes.length,e!=t.owner._id&&(u.disabled=!0,u.hidden=!0),u.addEventListener("click",(function(){n(t._id,c)})),i.addEventListener("click",(function(){o(t.link,t.name)})),l.addEventListener("click",(function(e){r(t._id,e.target,e.target.classList.contains("card__like-button_is-active"))})),c},i=function(t,e,n){e?t.classList.remove("card__like-button_is-active"):t.classList.add("card__like-button_is-active"),t.textContent=n},a=function(c,a,u){var l;u?(l=c,fetch(t+e+"/cards/likes/"+l,{method:"DELETE",headers:{authorization:n,"Content-Type":o}}).then((function(t){return r(t)}))).then((function(t){i(a,u,t.likes.length)})).catch((function(t){console.log(t)})):function(c){return fetch(t+e+"/cards/likes/"+c,{method:"PUT",headers:{authorization:n,"Content-Type":o}}).then((function(t){return r(t)}))}(c).then((function(t){i(a,u,t.likes.length)})).catch((function(t){console.log(t)}))},u=function(c,i){var a;(a=c,fetch(t+e+"/cards/"+a,{method:"DELETE",headers:{authorization:n,"Content-Type":o}}).then((function(t){return r(t)}))).then((function(t){i.remove()})).catch((function(t){console.log(t)}))},l=function(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",f)},s=function(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",f)},d=function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&s(t.currentTarget)},f=function(t){if("Escape"===t.key){var e=document.querySelector(".popup_is-opened");s(e)}},p=function(t,e,n){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?y(t,e,n):m(t,e,e.validationMessage,n)},m=function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)},y=function(t,e,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass)},v=function(t,e,n){_(t)?(e.disabled=!0,e.classList.add(n.inactiveButtonClass)):(e.disabled=!1,e.classList.remove(n.inactiveButtonClass))},_=function(t){return t.some((function(t){return!t.validity.valid}))},h=function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);v(n,o,e),n.forEach((function(n){y(t,n,e)}))};function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var b,C={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},g=document.querySelector(".places__list"),q=document.querySelector(".profile__title"),E=document.querySelector(".profile__description"),k=document.querySelector(".profile__image"),L=document.forms.namedItem("edit-profile"),x=document.forms.namedItem("edit-avatar"),A=document.forms.namedItem("new-place"),T=document.querySelector(".profile__edit-button"),w=document.querySelector(".profile__add-button"),j=L.querySelector(".popup__button"),z=A.querySelector(".popup__button"),I=x.querySelector(".popup__button"),O=document.querySelectorAll(".popup"),B=document.querySelector(".popup_type_edit"),P=document.querySelector(".popup_type_edit-avatar"),D=document.querySelector(".popup_type_new-card"),M=document.querySelector(".popup_type_image"),N=document.querySelector(".popup__image"),J=document.querySelector(".popup__caption"),H=function(t,e){l(M),N.src=t,N.alt=e,J.textContent=e};Promise.all([fetch(t+e+"/users/me",{headers:{authorization:n}}).then((function(t){return r(t)})),fetch(t+e+"/cards",{headers:{authorization:n}}).then((function(t){return r(t)}))]).then((function(t){var e,n,o=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,c,i,a=[],u=!0,l=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=c.call(n)).done)&&(a.push(o.value),a.length!==e);u=!0);}catch(t){l=!0,r=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],i=o[1];b=r._id,q.textContent=r.name,E.textContent=r.about,k.style.backgroundImage="url("+r.avatar+")",i.forEach((function(t){!function(t,e){var n=c(t,e,u,H,a);g.append(n)}(t,b)}))})).catch((function(t){console.log(t)})),T.addEventListener("click",(function(){l(B),L.elements.name.value=q.textContent,L.elements.description.value=E.textContent})),w.addEventListener("click",(function(){l(D)})),k.addEventListener("click",(function(){l(P)})),function(t){t.forEach((function(t){t.addEventListener("click",d)}))}(O),L.addEventListener("submit",(function(c){var i,a;c.preventDefault(),j.textContent="Сохранение...",(i=L.elements.name.value,a=L.elements.description.value,fetch(t+e+"/users/me",{method:"PATCH",headers:{authorization:n,"Content-Type":o},body:JSON.stringify({name:i,about:a})}).then((function(t){return r(t)}))).then((function(t){q.textContent=t.name,E.textContent=t.about,s(B)})).catch((function(t){console.log(t)})).finally((function(){j.textContent="Сохранить"}))})),A.addEventListener("submit",(function(i){var l,d;i.preventDefault(),z.textContent="Сохранение...",(l=A.elements.place__name.value,d=A.elements.link.value,fetch(t+e+"/cards",{method:"POST",headers:{authorization:n,"Content-Type":o},body:JSON.stringify({name:l,link:d})}).then((function(t){return r(t)}))).then((function(t){var e=c(t,b,u,H,a);g.prepend(e),h(A,C),s(D),i.target.reset()})).catch((function(t){console.log(t)})).finally((function(){z.textContent="Сохранить"}))})),x.addEventListener("submit",(function(c){return function(c){var i;c.preventDefault(),I.textContent="Сохранение...",(i=x.elements.link.value,fetch(t+e+"/users/me/avatar",{method:"PATCH",headers:{authorization:n,"Content-Type":o},body:JSON.stringify({avatar:i})}).then((function(t){return r(t)}))).then((function(t){k.style.backgroundImage="url("+t.avatar+")",x.reset(),h(x,C),s(P)})).catch((function(t){console.log(t)})).finally((function(){I.textContent="Сохранить"}))}(c)})),function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){!function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);v(n,o,e),n.forEach((function(r){r.addEventListener("input",(function(c){p(t,r,e),v(n,o,e)}))}))}(e,t)}))}(C)})();
//# sourceMappingURL=main.js.map